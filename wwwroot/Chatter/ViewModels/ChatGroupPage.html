<link href="/Chatter/css/chatter.css" rel="stylesheet" />
        
<template>
    <h2>{{Name}}</h2>
    <div>
        <template if="{{UserKey}}">
            Signed in as <b>{{UserName$}}</b>
        </template>
        <template if="{{!UserKey}}">
            You are not signed in, you messages will be send anonymously
        </template>
    </div>
    <div>
        <template repeat="{{ChatMessagePages}}">
            <polyjuice-include partial="{{}}"></polyjuice-include>
        </template>
    </div>
    <div>
        <input type="text" update-on="input" value="{{ChatMessage.Text$}}" onkeyup="if (event.keyCode == 13) this.templateInstance.model.Send$++;" class="form-control" placeholder="Input your message" />
    </div>
    <div>
        Attachments
    </div>
    <div>
        <input type="text" update-on="input" class="form-control" value="{{AttachmentName$}}" onblur="getModel(this).ClearFoundAttachments$++" placeholder="Type to find an attachent" />
        <template if="{{FoundAttachment.length}}">
            <ul class="autocomplete">
                <template repeat="{{FoundAttachment}}">
                    <li>
                        <a href="javascript:" onmousedown="this.templateInstance.model.Choose$++">{{Name}} - {{Type}}</a>
                    </li>
                </template>
            </ul>
        </template>
    </div>
    <div>
        <table class="table">
            <template repeat="{{ChatMessage.ChatAttachments}}">
                <tr>
                    <td>
                        <span>{{Attachment.Name}}</span> - <span>{{Attachment.Type}}</span>
                    </td>
                    <td>
                        <button type="button" class="btn btn-default btn-xs" onclick="getModel(this).Delete$++">Delete</button>
                    </td>
                </tr>
            </template>
        </table>
    </div>
    <div>
        <button class="btn btn-primary" onclick="getModel(this).Send$++">Send</button>
    </div>
    <div>
        <a href="/chatter" class="btn btn-default">Go back</a>
    </div>
    <div hidden?="{{!Warning}}">{{Warning}}</div>
</template>
