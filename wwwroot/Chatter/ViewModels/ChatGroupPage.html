<link href="/Chatter/css/chatter.css" rel="stylesheet" />
        
<template>
    <template is="dom-bind">
        <h2 class="group-name">{{model.Name}}</h2>
        <div class="group-back-button">
            <a href="/chatter" class="btn btn-default btn-sm">Go back</a>
        </div>
        <div class="group-user">
            <template is="dom-if" if="{{model.UserKey}}">
                Signed in as
                <b>{{model.UserName$}}</b>
            </template>
            <template is="dom-if" if="{{!model.UserKey}}">
                You are not signed in, you messages will be send anonymously
            </template>
        </div>
        <div class="group-messages">
            <template is="dom-repeat" items="{{model.ChatMessagePages}}">
                <starcounter-include partial="{{item}}"></starcounter-include>
            </template>
        </div>

        <style>
            .expandable {
                -moz-transition: height .5s;
                -ms-transition: height .5s;
                -o-transition: height .5s;
                -webkit-transition: height .5s;
                transition: height .5s;
                height: 0;
                overflow: hidden;
                margin-top: 1px;
            }

            #more-button {
                box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.4);
            }
            .application {
                margin-top: 15px;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                width: 100%;
            }

            .aplication-container {
                float: left;
                width: 95%;
                margin-bottom: 0px;
            }

            .aplication-add {
                float: left;
                width: 5%;
                text-align: center;
            }

            .aplication-add-button {
            }
        </style>
        <div>
            <button class="btn btn-default" id="more-button" onclick="growDiv()">Add attachment <span class="caret" /></button>
            <div id='expandablePanel' class="expandable panel panel-default">
                <div class='panel-body'>
                    <div class="application">
                        <div class="aplication-container panel panel-default">
                            <div class="panel-body">
                                Images
                            </div>
                        </div>
                        <div class="aplication-add">
                            <button type="button" class="btn btn-small btn-success aplication-add-button" onclick="++this.value;" value="{{model.Send$::click}}">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>
                        </div>
                    </div>
                    <div class="application">
                        <div class="aplication-container panel panel-default">
                            <div class="panel-body">
                                People
                            </div>
                        </div>
                        <div class="aplication-add">
                            <button type="button" class="btn btn-small btn-success aplication-add-button" onclick="++this.value;" value="{{model.Send$::click}}">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>
                        </div>
                    </div>
                    <div class="application">
                        <div class="aplication-container panel panel-default">
                            <div class="panel-body">
                                <input type="text" value="{{model.ChatMessage.Text$::input}}" on-keyup="onInputKeyup" class="form-control" placeholder="Input your message" />
                            </div>
                        </div>
                        <div class="aplication-add">
                            <button type="button" class="btn btn-small btn-success aplication-add-button" onclick="++this.value;" value="{{model.Send$::click}}">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="group-warning">
            <template is="dom-if" if="{{model.Warning}}">
                <span>{{model.Warning}}</span>
            </template>
        </div>
        <dom-bind-notifier observed-object="{{model}}" path="model" deep></dom-bind-notifier>
    </template>
    <script>
        (function init() {
            var template = (document._currentScript || document.currentScript).previousElementSibling;

            template.onInputKeyup = function (e) {
                if (e.keyCode == 13) {
                    template.set("model.Send$", template.model.Send$ + 1);
                }
            };

            template.clearFoundAttachments = function () {
                setTimeout(function () {
                    template.set("model.ClearFoundAttachments$", template.model.ClearFoundAttachments$ + 1);
                }, 100);
            };
        })();

        function growDiv() {
            var growDiv = document.getElementById('expandablePanel');
            if (growDiv.clientHeight) {
                growDiv.style.height = 0;
            } else {
                var wrapper = growDiv.querySelector('.panel-body');
                growDiv.style.height = wrapper.clientHeight + "px";
            }
            document.activeElement.blur()
        }
    </script>
</template>
